@using System.Diagnostics
@inject ISongService SongService
@inject IJSRuntime jSRuntime

<div class="grid-cols-12 grid h-full w-full relative">

	<!-- |===== LEFT SIDE ======| -->
	<div class="border-r-2 col-span-5 border-sidepanel bg-container h-full  overflow-hidden rounded-r-3xl p-10">

		<div class="@(editMode ? "" : "hidden") flex flex-col w-full h-full  ">
			<!--[ EDIT MODE: Lyric Text]-->
			<label class="font-bold tracking-widest opacity-50 text-accented">LYRIC EDITOR</label>
			<textarea class="bg-sidepanel text-default text-sm m-px border-0 mb-3 w-full min-h-1/2 h-1/2 max-h-1/2 rounded-xl px-4 py-3 placeholder-l-text placeholder-opacity-50 ring-l-primary ring-opacity-50 focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
					  value="@selectedSong.LyricText" @oninput="(e => { selectedSong.LyricText = e.Value.ToString(); UpdateLyrics();})" spellcheck="false" placeholder="Lyric" />
			<!--[ EDIT MODE: Sequence ]-->

			<label class="font-bold tracking-widest opacity-50 text-accented">SEQUENCE</label>
			<input class="bg-sidepanel text-default text-sm m-px border-0 mb-3 w-full rounded-xl px-4 py-3 placeholder-l-text placeholder-opacity-50 ring-l-primary ring-opacity-50 focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
					  value="@selectedSong.Sequence" @oninput="(e => { selectedSong.Sequence = e.Value.ToString(); UpdateLyrics();})" spellcheck="false" placeholder="[ 1, C, 2... ]" />

			<!--[ EDIT MODE: Tags ]-->
			<label class="font-bold tracking-widest opacity-50 text-accented">TAGS</label>
			<input class="bg-sidepanel text-default text-sm m-px border-0 mb-3 w-full rounded-xl px-4 py-3 placeholder-l-text placeholder-opacity-50 ring-l-primary ring-opacity-50 focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
					  value="@selectedSong.Tags" @oninput="(e => { selectedSong.Tags = e.Value.ToString(); UpdateLyrics();})" spellcheck="false" placeholder="Solemn, Joyful, Communion, Blood" />

		</div>

		<div class="@(editMode ? "hidden" : "") flex flex-col w-full h-full space-y-3 overflow-hidden">

			<!--[ SEARCH INPUT ]-->
			<div class="flex w-full flex-col space-y-2">
				<BeaconSearchMode ActiveSearchMode="currentSearchMode" SearchModeChanged="switchSearchMode"></BeaconSearchMode>
				<DebounceInput class="bg-default text-accented border-0 h-16 mx-px rounded-xl px-3 text-sm placeholder-l-text placeholder-opacity-50 ring-l-primary focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
							   placeholder="Search" @bind-Value="searchText" @bind-Value:event="oninput" OnValueChanged="OnSearchChanged"
							   DebounceTime="100" ></DebounceInput>
			</div>

			<!--[ SONG LIST ]-->
			<SongList Songs="songs" SelectedSong="selectedSong" IsQueueMode="isQueueMode" SelectedSongChanged="SelectedSongChanged"></SongList>

			<!--[ QUEUE AND ADD SONG ]-->
			<div class="flex justify-between">
				<BeaconToggle IconUnchecked="L" MessageUnchecked="VIEW QUEUE" IconChecked="L" MessageChecked="BACK TO SONGS"></BeaconToggle>
				<BeaconButton Message="Add Song" Icon="S" OnClick="AddSongClick"></BeaconButton>
			</div>

		</div>
		
	</div>
		

	<!-- |===== RIGHT SIDE ======| -->
	<div class="col-span-7 bg-default flex h-full w-full flex-col overflow-auto">

		<!--------[ TOP ]-------->
		<div class="via-l-container/25 border-b-2 border-sidepanel to-l-container/0 flex h-32 w-full items-center rounded-b-3xl bg-gradient-to-t from-l-container px-10 dark:from-d-container dark:via-d-container/25 dark:to-d-container/0">

			<!--[ KEY ]-->
			<div class="bg-sidepanel flex size-16 flex-none items-center justify-center rounded-xl">
				<input class="text-l-text-accent flex text-center text-2xl dark:text-d-text-accent bg-transparent border-0 focus:ring-0"
					   placeholder="Key" @bind-value="@selectedSong.Key" @bind-value:event="oninput" spellcheck="false" disabled="@(!editMode)"/>
			</div>


			<!--[ TITLE AND AUTHOR ]-->
			<p class="flex-1 mx-3 truncate leading-7">
				@if (!editMode)
				{
					<span class="text-accented w-full text-3xl font-bold">@selectedSong.Title</span><br />
					<span class="text-accented text-lg">@selectedSong.Author</span>

				}
				else
				{
					<input class="bg-sidepanel text-accented m-px border-0 w-full rounded-lg px-3 py-0.5 text-lg placeholder-l-text placeholder-opacity-50 ring-l-primary ring-opacity-50 focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
						   @bind-value="@selectedSong.Title" @bind-value:event="oninput" spellcheck="false" placeholder="Song Title" />

					<br />

					<input class="bg-sidepanel text-accented m-px border-0 rounded-lg px-3 py-0.5 text-sm placeholder-l-text placeholder-opacity-50 ring-l-primary focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
						   @bind-value="selectedSong.Author" @bind-value:event="oninput" spellcheck="false" placeholder="Author" />
				}
			</p>


			<!--[ ACTION BUTTONS ]-->
			<div class="flex flex-none space-x-3">
				@if (editMode)
				{
					<BeaconButton Message="DISCARD" Icon="D" Hover="hover:bg-l-red dark:hover:bg-d-red hover:text-accented-on-primary" OnClick="DiscardEditClick"></BeaconButton>
					<BeaconButton Message="SAVE" Icon="s" Background="bg-primary text-accented-on-primary" Hover="hover:bg-l-sidepanel hover:text-primary" OnClick="SaveEditClick"></BeaconButton>
				}
				else
				{
					<BeaconButton Message="EDIT" Icon="E" OnClick="EditButtonClick"></BeaconButton>
				}
			</div>

		</div>


		<!-------[ BOTTOM ]-------->

		<!--[ LANGUAGE ]-->
		<div class="px-10 pt-5">
			@if (editMode)
			{
				<label class="font-bold tracking-widest opacity-50 text-accented">LANGUAGE</label>
				<input class="bg-sidepanel text-default text-sm m-px mb-2 border-0 w-fit rounded-xl px-4 py-3 placeholder-l-text placeholder-opacity-50 ring-l-primary ring-opacity-50 focus:ring-1 dark:ring-d-primary dark:placeholder-d-text dark:placeholder-opacity-50"
					   value="@selectedSong.Language" @oninput="(e => { selectedSong.Language = e.Value.ToString(); UpdateLyrics();})" spellcheck="false" placeholder="Language" />

			}
			else
			{
				<SongLanguageList SelectedSong="selectedSong" Songs="languagesOfSelectedSong" SelectedSongChanged="SelectedSongChanged" AddLanguage="AddLanguageClick"></SongLanguageList>
				
			}
		</div>

		<!--[ LYRICS ]-->
		<LyricList SelectedLyric="selectedLyric" Lyrics="lyrics" SelectedLyricChanged="SelectedLyricChanged"></LyricList>


	</div> 

</div>
